{"dependencies":[{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":112},"end":{"line":4,"column":33,"index":145}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"./keyDerivation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":146},"end":{"line":5,"column":54,"index":200}}],"key":"pLCGKbCUrckLcIDYaFZ/kr3WNgs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.hashPin = hashPin;\n  exports.verifyPin = verifyPin;\n  exports.generatePinSalt = generatePinSalt;\n  var _cryptoJs = require(_dependencyMap[0], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _keyDerivation = require(_dependencyMap[1], \"./keyDerivation\");\n  // PIN Hashing Service - Zero Knowledge Vault\n  // PINs are hashed and salted locally, NEVER stored in plaintext\n\n  const HASH_ITERATIONS = 50000;\n\n  /**\n   * Hash a PIN with salt using PBKDF2\n   * Returns the hash that can be stored locally for verification\n   */\n  function hashPin(pin, salt) {\n    const hash = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: 256 / 32,\n      iterations: HASH_ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return hash.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Verify a PIN against stored hash\n   */\n  function verifyPin(pin, salt, storedHash) {\n    const computedHash = hashPin(pin, salt);\n    // Constant-time comparison to prevent timing attacks\n    if (computedHash.length !== storedHash.length) return false;\n    let result = 0;\n    for (let i = 0; i < computedHash.length; i++) {\n      result |= computedHash.charCodeAt(i) ^ storedHash.charCodeAt(i);\n    }\n    return result === 0;\n  }\n\n  /**\n   * Generate a salt for PIN hashing\n   */\n  async function generatePinSalt() {\n    return (0, _keyDerivation.generateRandomBytes)(16);\n  }\n});","lineCount":56,"map":[[12,2,13,0,"exports"],[12,9,13,0],[12,10,13,0,"hashPin"],[12,17,13,0],[12,20,13,0,"hashPin"],[12,27,13,0],[13,2,25,0,"exports"],[13,9,25,0],[13,10,25,0,"verifyPin"],[13,19,25,0],[13,22,25,0,"verifyPin"],[13,31,25,0],[14,2,39,0,"exports"],[14,9,39,0],[14,10,39,0,"generatePinSalt"],[14,25,39,0],[14,28,39,0,"generatePinSalt"],[14,43,39,0],[15,2,4,0],[15,6,4,0,"_cryptoJs"],[15,15,4,0],[15,18,4,0,"require"],[15,25,4,0],[15,26,4,0,"_dependencyMap"],[15,40,4,0],[16,2,4,0],[16,6,4,0,"CryptoJS"],[16,14,4,0],[16,17,4,0,"_interopDefault"],[16,32,4,0],[16,33,4,0,"_cryptoJs"],[16,42,4,0],[17,2,5,0],[17,6,5,0,"_keyDerivation"],[17,20,5,0],[17,23,5,0,"require"],[17,30,5,0],[17,31,5,0,"_dependencyMap"],[17,45,5,0],[18,2,1,0],[19,2,2,0],[21,2,7,0],[21,8,7,6,"HASH_ITERATIONS"],[21,23,7,21],[21,26,7,24],[21,31,7,29],[23,2,9,0],[24,0,10,0],[25,0,11,0],[26,0,12,0],[27,2,13,7],[27,11,13,16,"hashPin"],[27,18,13,23,"hashPin"],[27,19,13,24,"pin"],[27,22,13,35],[27,24,13,37,"salt"],[27,28,13,49],[27,30,13,59],[28,4,14,2],[28,10,14,8,"hash"],[28,14,14,12],[28,17,14,15,"CryptoJS"],[28,25,14,23],[28,26,14,23,"default"],[28,33,14,23],[28,34,14,24,"PBKDF2"],[28,40,14,30],[28,41,14,31,"pin"],[28,44,14,34],[28,46,14,36,"CryptoJS"],[28,54,14,44],[28,55,14,44,"default"],[28,62,14,44],[28,63,14,45,"enc"],[28,66,14,48],[28,67,14,49,"Hex"],[28,70,14,52],[28,71,14,53,"parse"],[28,76,14,58],[28,77,14,59,"salt"],[28,81,14,63],[28,82,14,64],[28,84,14,66],[29,6,15,4,"keySize"],[29,13,15,11],[29,15,15,13],[29,18,15,16],[29,21,15,19],[29,23,15,21],[30,6,16,4,"iterations"],[30,16,16,14],[30,18,16,16,"HASH_ITERATIONS"],[30,33,16,31],[31,6,17,4,"hasher"],[31,12,17,10],[31,14,17,12,"CryptoJS"],[31,22,17,20],[31,23,17,20,"default"],[31,30,17,20],[31,31,17,21,"algo"],[31,35,17,25],[31,36,17,26,"SHA256"],[32,4,18,2],[32,5,18,3],[32,6,18,4],[33,4,19,2],[33,11,19,9,"hash"],[33,15,19,13],[33,16,19,14,"toString"],[33,24,19,22],[33,25,19,23,"CryptoJS"],[33,33,19,31],[33,34,19,31,"default"],[33,41,19,31],[33,42,19,32,"enc"],[33,45,19,35],[33,46,19,36,"Hex"],[33,49,19,39],[33,50,19,40],[34,2,20,0],[36,2,22,0],[37,0,23,0],[38,0,24,0],[39,2,25,7],[39,11,25,16,"verifyPin"],[39,20,25,25,"verifyPin"],[39,21,25,26,"pin"],[39,24,25,37],[39,26,25,39,"salt"],[39,30,25,51],[39,32,25,53,"storedHash"],[39,42,25,71],[39,44,25,82],[40,4,26,2],[40,10,26,8,"computedHash"],[40,22,26,20],[40,25,26,23,"hashPin"],[40,32,26,30],[40,33,26,31,"pin"],[40,36,26,34],[40,38,26,36,"salt"],[40,42,26,40],[40,43,26,41],[41,4,27,2],[42,4,28,2],[42,8,28,6,"computedHash"],[42,20,28,18],[42,21,28,19,"length"],[42,27,28,25],[42,32,28,30,"storedHash"],[42,42,28,40],[42,43,28,41,"length"],[42,49,28,47],[42,51,28,49],[42,58,28,56],[42,63,28,61],[43,4,29,2],[43,8,29,6,"result"],[43,14,29,12],[43,17,29,15],[43,18,29,16],[44,4,30,2],[44,9,30,7],[44,13,30,11,"i"],[44,14,30,12],[44,17,30,15],[44,18,30,16],[44,20,30,18,"i"],[44,21,30,19],[44,24,30,22,"computedHash"],[44,36,30,34],[44,37,30,35,"length"],[44,43,30,41],[44,45,30,43,"i"],[44,46,30,44],[44,48,30,46],[44,50,30,48],[45,6,31,4,"result"],[45,12,31,10],[45,16,31,14,"computedHash"],[45,28,31,26],[45,29,31,27,"charCodeAt"],[45,39,31,37],[45,40,31,38,"i"],[45,41,31,39],[45,42,31,40],[45,45,31,43,"storedHash"],[45,55,31,53],[45,56,31,54,"charCodeAt"],[45,66,31,64],[45,67,31,65,"i"],[45,68,31,66],[45,69,31,67],[46,4,32,2],[47,4,33,2],[47,11,33,9,"result"],[47,17,33,15],[47,22,33,20],[47,23,33,21],[48,2,34,0],[50,2,36,0],[51,0,37,0],[52,0,38,0],[53,2,39,7],[53,17,39,22,"generatePinSalt"],[53,32,39,37,"generatePinSalt"],[53,33,39,37],[53,35,39,57],[54,4,40,2],[54,11,40,9],[54,15,40,9,"generateRandomBytes"],[54,29,40,28],[54,30,40,28,"generateRandomBytes"],[54,49,40,28],[54,51,40,29],[54,53,40,31],[54,54,40,32],[55,2,41,0],[56,0,41,1],[56,3]],"functionMap":{"names":["<global>","hashPin","verifyPin","generatePinSalt"],"mappings":"AAA;OCY;CDO;OEK;CFS;OGK;CHE"},"hasCjsExports":false},"type":"js/module"}]}