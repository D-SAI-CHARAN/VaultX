{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":112},"end":{"line":4,"column":33,"index":145}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"./keyDerivation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":146},"end":{"line":5,"column":54,"index":200}}],"key":"pLCGKbCUrckLcIDYaFZ/kr3WNgs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.hashPin = hashPin;\n  exports.verifyPin = verifyPin;\n  exports.generatePinSalt = generatePinSalt;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _cryptoJs = require(_dependencyMap[1], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _keyDerivation = require(_dependencyMap[2], \"./keyDerivation\");\n  // PIN Hashing Service - Zero Knowledge Vault\n  // PINs are hashed and salted locally, NEVER stored in plaintext\n\n  var HASH_ITERATIONS = 50000;\n\n  /**\n   * Hash a PIN with salt using PBKDF2\n   * Returns the hash that can be stored locally for verification\n   */\n  function hashPin(pin, salt) {\n    var hash = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: 256 / 32,\n      iterations: HASH_ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return hash.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Verify a PIN against stored hash\n   */\n  function verifyPin(pin, salt, storedHash) {\n    var computedHash = hashPin(pin, salt);\n    // Constant-time comparison to prevent timing attacks\n    if (computedHash.length !== storedHash.length) return false;\n    var result = 0;\n    for (var i = 0; i < computedHash.length; i++) {\n      result |= computedHash.charCodeAt(i) ^ storedHash.charCodeAt(i);\n    }\n    return result === 0;\n  }\n\n  /**\n   * Generate a salt for PIN hashing\n   */\n  function generatePinSalt() {\n    return _generatePinSalt.apply(this, arguments);\n  }\n  function _generatePinSalt() {\n    _generatePinSalt = (0, _asyncToGenerator.default)(function* () {\n      return (0, _keyDerivation.generateRandomBytes)(16);\n    });\n    return _generatePinSalt.apply(this, arguments);\n  }\n});","lineCount":64,"map":[[12,2,13,0,"exports"],[12,9,13,0],[12,10,13,0,"hashPin"],[12,17,13,0],[12,20,13,0,"hashPin"],[12,27,13,0],[13,2,25,0,"exports"],[13,9,25,0],[13,10,25,0,"verifyPin"],[13,19,25,0],[13,22,25,0,"verifyPin"],[13,31,25,0],[14,2,39,0,"exports"],[14,9,39,0],[14,10,39,0,"generatePinSalt"],[14,25,39,0],[14,28,39,0,"generatePinSalt"],[14,43,39,0],[15,2,41,1],[15,6,41,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,42,41,1],[15,45,41,1,"require"],[15,52,41,1],[15,53,41,1,"_dependencyMap"],[15,67,41,1],[16,2,41,1],[16,6,41,1,"_asyncToGenerator"],[16,23,41,1],[16,26,41,1,"_interopDefault"],[16,41,41,1],[16,42,41,1,"_babelRuntimeHelpersAsyncToGenerator"],[16,78,41,1],[17,2,4,0],[17,6,4,0,"_cryptoJs"],[17,15,4,0],[17,18,4,0,"require"],[17,25,4,0],[17,26,4,0,"_dependencyMap"],[17,40,4,0],[18,2,4,0],[18,6,4,0,"CryptoJS"],[18,14,4,0],[18,17,4,0,"_interopDefault"],[18,32,4,0],[18,33,4,0,"_cryptoJs"],[18,42,4,0],[19,2,5,0],[19,6,5,0,"_keyDerivation"],[19,20,5,0],[19,23,5,0,"require"],[19,30,5,0],[19,31,5,0,"_dependencyMap"],[19,45,5,0],[20,2,1,0],[21,2,2,0],[23,2,7,0],[23,6,7,6,"HASH_ITERATIONS"],[23,21,7,21],[23,24,7,24],[23,29,7,29],[25,2,9,0],[26,0,10,0],[27,0,11,0],[28,0,12,0],[29,2,13,7],[29,11,13,16,"hashPin"],[29,18,13,23,"hashPin"],[29,19,13,24,"pin"],[29,22,13,35],[29,24,13,37,"salt"],[29,28,13,49],[29,30,13,59],[30,4,14,2],[30,8,14,8,"hash"],[30,12,14,12],[30,15,14,15,"CryptoJS"],[30,23,14,23],[30,24,14,23,"default"],[30,31,14,23],[30,32,14,24,"PBKDF2"],[30,38,14,30],[30,39,14,31,"pin"],[30,42,14,34],[30,44,14,36,"CryptoJS"],[30,52,14,44],[30,53,14,44,"default"],[30,60,14,44],[30,61,14,45,"enc"],[30,64,14,48],[30,65,14,49,"Hex"],[30,68,14,52],[30,69,14,53,"parse"],[30,74,14,58],[30,75,14,59,"salt"],[30,79,14,63],[30,80,14,64],[30,82,14,66],[31,6,15,4,"keySize"],[31,13,15,11],[31,15,15,13],[31,18,15,16],[31,21,15,19],[31,23,15,21],[32,6,16,4,"iterations"],[32,16,16,14],[32,18,16,16,"HASH_ITERATIONS"],[32,33,16,31],[33,6,17,4,"hasher"],[33,12,17,10],[33,14,17,12,"CryptoJS"],[33,22,17,20],[33,23,17,20,"default"],[33,30,17,20],[33,31,17,21,"algo"],[33,35,17,25],[33,36,17,26,"SHA256"],[34,4,18,2],[34,5,18,3],[34,6,18,4],[35,4,19,2],[35,11,19,9,"hash"],[35,15,19,13],[35,16,19,14,"toString"],[35,24,19,22],[35,25,19,23,"CryptoJS"],[35,33,19,31],[35,34,19,31,"default"],[35,41,19,31],[35,42,19,32,"enc"],[35,45,19,35],[35,46,19,36,"Hex"],[35,49,19,39],[35,50,19,40],[36,2,20,0],[38,2,22,0],[39,0,23,0],[40,0,24,0],[41,2,25,7],[41,11,25,16,"verifyPin"],[41,20,25,25,"verifyPin"],[41,21,25,26,"pin"],[41,24,25,37],[41,26,25,39,"salt"],[41,30,25,51],[41,32,25,53,"storedHash"],[41,42,25,71],[41,44,25,82],[42,4,26,2],[42,8,26,8,"computedHash"],[42,20,26,20],[42,23,26,23,"hashPin"],[42,30,26,30],[42,31,26,31,"pin"],[42,34,26,34],[42,36,26,36,"salt"],[42,40,26,40],[42,41,26,41],[43,4,27,2],[44,4,28,2],[44,8,28,6,"computedHash"],[44,20,28,18],[44,21,28,19,"length"],[44,27,28,25],[44,32,28,30,"storedHash"],[44,42,28,40],[44,43,28,41,"length"],[44,49,28,47],[44,51,28,49],[44,58,28,56],[44,63,28,61],[45,4,29,2],[45,8,29,6,"result"],[45,14,29,12],[45,17,29,15],[45,18,29,16],[46,4,30,2],[46,9,30,7],[46,13,30,11,"i"],[46,14,30,12],[46,17,30,15],[46,18,30,16],[46,20,30,18,"i"],[46,21,30,19],[46,24,30,22,"computedHash"],[46,36,30,34],[46,37,30,35,"length"],[46,43,30,41],[46,45,30,43,"i"],[46,46,30,44],[46,48,30,46],[46,50,30,48],[47,6,31,4,"result"],[47,12,31,10],[47,16,31,14,"computedHash"],[47,28,31,26],[47,29,31,27,"charCodeAt"],[47,39,31,37],[47,40,31,38,"i"],[47,41,31,39],[47,42,31,40],[47,45,31,43,"storedHash"],[47,55,31,53],[47,56,31,54,"charCodeAt"],[47,66,31,64],[47,67,31,65,"i"],[47,68,31,66],[47,69,31,67],[48,4,32,2],[49,4,33,2],[49,11,33,9,"result"],[49,17,33,15],[49,22,33,20],[49,23,33,21],[50,2,34,0],[52,2,36,0],[53,0,37,0],[54,0,38,0],[55,2,36,0],[55,11,39,22,"generatePinSalt"],[55,26,39,37,"generatePinSalt"],[55,27,39,37],[56,4,39,37],[56,11,39,37,"_generatePinSalt"],[56,27,39,37],[56,28,39,37,"apply"],[56,33,39,37],[56,40,39,37,"arguments"],[56,49,39,37],[57,2,39,37],[58,2,39,37],[58,11,39,37,"_generatePinSalt"],[58,28,39,37],[59,4,39,37,"_generatePinSalt"],[59,20,39,37],[59,27,39,37,"_asyncToGenerator"],[59,44,39,37],[59,45,39,37,"default"],[59,52,39,37],[59,54,39,7],[59,67,39,57],[60,6,40,2],[60,13,40,9],[60,17,40,9,"generateRandomBytes"],[60,31,40,28],[60,32,40,28,"generateRandomBytes"],[60,51,40,28],[60,53,40,29],[60,55,40,31],[60,56,40,32],[61,4,41,0],[61,5,41,1],[62,4,41,1],[62,11,41,1,"_generatePinSalt"],[62,27,41,1],[62,28,41,1,"apply"],[62,33,41,1],[62,40,41,1,"arguments"],[62,49,41,1],[63,2,41,1],[64,0,41,1],[64,3]],"functionMap":{"names":["<global>","hashPin","verifyPin","generatePinSalt"],"mappings":"AAA;OCY;CDO;OEK;CFS;OGK;CHE"},"hasCjsExports":false},"type":"js/module"}]}