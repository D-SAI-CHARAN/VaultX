{"dependencies":[{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":107},"end":{"line":4,"column":33,"index":140}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"expo-crypto","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":141},"end":{"line":5,"column":42,"index":183}}],"key":"+Akla+LrhuGGU54C9zXxLPlFUv4=","exportNames":["*"],"imports":1}},{"name":"buffer","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":54,"column":0,"index":1528},"end":{"line":54,"column":32,"index":1560}}],"key":"L2R9OUI0/cSYwzijo34ce4VujKY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.generateRandomBytes = generateRandomBytes;\n  exports.deriveMasterKey = deriveMasterKey;\n  exports.generateSalt = generateSalt;\n  exports.generateFEK = generateFEK;\n  exports.generateIV = generateIV;\n  var _cryptoJs = require(_dependencyMap[0], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _expoCrypto = require(_dependencyMap[1], \"expo-crypto\");\n  var ExpoRandom = _interopNamespace(_expoCrypto);\n  var _buffer = require(_dependencyMap[2], \"buffer\");\n  // PBKDF2 Key Derivation - Zero Knowledge Vault\n  // Master Key is NEVER stored, always re-derived from PIN\n\n  const ITERATIONS = 100000; // Minimum 100,000 as per spec\n  const KEY_SIZE = 256 / 32; // 256 bits = 8 words (32 bits each)\n  const SALT_SIZE = 16; // 16 bytes = 128 bits\n\n  /**\n   * Generate cryptographically secure random bytes\n   */\n  async function generateRandomBytes(size) {\n    const randomBytes = await ExpoRandom.getRandomBytesAsync(size);\n    return _buffer.Buffer.from(randomBytes).toString('hex');\n  }\n\n  /**\n   * Derive master key from PIN using PBKDF2-HMAC-SHA256\n   * Key is 256 bits, never stored, re-derived on every unlock\n   */\n  function deriveMasterKey(pin, salt) {\n    const key = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: KEY_SIZE,\n      iterations: ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return key.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Generate a new salt for key derivation\n   */\n  async function generateSalt() {\n    return generateRandomBytes(SALT_SIZE);\n  }\n\n  /**\n   * Generate a random File Encryption Key (FEK) for each document\n   */\n  async function generateFEK() {\n    return generateRandomBytes(32); // 256 bits\n  }\n\n  /**\n   * Generate initialization vector for AES-GCM\n   */\n  async function generateIV() {\n    return generateRandomBytes(12); // 96 bits for GCM\n  }\n\n  // Buffer polyfill for React Native\n\n  global.Buffer = global.Buffer || _buffer.Buffer;\n});","lineCount":89,"map":[[27,2,14,0,"exports"],[27,9,14,0],[27,10,14,0,"generateRandomBytes"],[27,29,14,0],[27,32,14,0,"generateRandomBytes"],[27,51,14,0],[28,2,23,0,"exports"],[28,9,23,0],[28,10,23,0,"deriveMasterKey"],[28,25,23,0],[28,28,23,0,"deriveMasterKey"],[28,43,23,0],[29,2,35,0,"exports"],[29,9,35,0],[29,10,35,0,"generateSalt"],[29,22,35,0],[29,25,35,0,"generateSalt"],[29,37,35,0],[30,2,42,0,"exports"],[30,9,42,0],[30,10,42,0,"generateFEK"],[30,21,42,0],[30,24,42,0,"generateFEK"],[30,35,42,0],[31,2,49,0,"exports"],[31,9,49,0],[31,10,49,0,"generateIV"],[31,20,49,0],[31,23,49,0,"generateIV"],[31,33,49,0],[32,2,4,0],[32,6,4,0,"_cryptoJs"],[32,15,4,0],[32,18,4,0,"require"],[32,25,4,0],[32,26,4,0,"_dependencyMap"],[32,40,4,0],[33,2,4,0],[33,6,4,0,"CryptoJS"],[33,14,4,0],[33,17,4,0,"_interopDefault"],[33,32,4,0],[33,33,4,0,"_cryptoJs"],[33,42,4,0],[34,2,5,0],[34,6,5,0,"_expoCrypto"],[34,17,5,0],[34,20,5,0,"require"],[34,27,5,0],[34,28,5,0,"_dependencyMap"],[34,42,5,0],[35,2,5,0],[35,6,5,0,"ExpoRandom"],[35,16,5,0],[35,19,5,0,"_interopNamespace"],[35,36,5,0],[35,37,5,0,"_expoCrypto"],[35,48,5,0],[36,2,54,0],[36,6,54,0,"_buffer"],[36,13,54,0],[36,16,54,0,"require"],[36,23,54,0],[36,24,54,0,"_dependencyMap"],[36,38,54,0],[37,2,1,0],[38,2,2,0],[40,2,7,0],[40,8,7,6,"ITERATIONS"],[40,18,7,16],[40,21,7,19],[40,27,7,25],[40,28,7,26],[40,29,7,27],[41,2,8,0],[41,8,8,6,"KEY_SIZE"],[41,16,8,14],[41,19,8,17],[41,22,8,20],[41,25,8,23],[41,27,8,25],[41,28,8,26],[41,29,8,27],[42,2,9,0],[42,8,9,6,"SALT_SIZE"],[42,17,9,15],[42,20,9,18],[42,22,9,20],[42,23,9,21],[42,24,9,22],[44,2,11,0],[45,0,12,0],[46,0,13,0],[47,2,14,7],[47,17,14,22,"generateRandomBytes"],[47,36,14,41,"generateRandomBytes"],[47,37,14,42,"size"],[47,41,14,54],[47,43,14,73],[48,4,15,2],[48,10,15,8,"randomBytes"],[48,21,15,19],[48,24,15,22],[48,30,15,28,"ExpoRandom"],[48,40,15,38],[48,41,15,39,"getRandomBytesAsync"],[48,60,15,58],[48,61,15,59,"size"],[48,65,15,63],[48,66,15,64],[49,4,16,2],[49,11,16,9,"Buffer"],[49,18,16,15],[49,19,16,15,"Buffer"],[49,25,16,15],[49,26,16,16,"from"],[49,30,16,20],[49,31,16,21,"randomBytes"],[49,42,16,32],[49,43,16,33],[49,44,16,34,"toString"],[49,52,16,42],[49,53,16,43],[49,58,16,48],[49,59,16,49],[50,2,17,0],[52,2,19,0],[53,0,20,0],[54,0,21,0],[55,0,22,0],[56,2,23,7],[56,11,23,16,"deriveMasterKey"],[56,26,23,31,"deriveMasterKey"],[56,27,23,32,"pin"],[56,30,23,43],[56,32,23,45,"salt"],[56,36,23,57],[56,38,23,67],[57,4,24,2],[57,10,24,8,"key"],[57,13,24,11],[57,16,24,14,"CryptoJS"],[57,24,24,22],[57,25,24,22,"default"],[57,32,24,22],[57,33,24,23,"PBKDF2"],[57,39,24,29],[57,40,24,30,"pin"],[57,43,24,33],[57,45,24,35,"CryptoJS"],[57,53,24,43],[57,54,24,43,"default"],[57,61,24,43],[57,62,24,44,"enc"],[57,65,24,47],[57,66,24,48,"Hex"],[57,69,24,51],[57,70,24,52,"parse"],[57,75,24,57],[57,76,24,58,"salt"],[57,80,24,62],[57,81,24,63],[57,83,24,65],[58,6,25,4,"keySize"],[58,13,25,11],[58,15,25,13,"KEY_SIZE"],[58,23,25,21],[59,6,26,4,"iterations"],[59,16,26,14],[59,18,26,16,"ITERATIONS"],[59,28,26,26],[60,6,27,4,"hasher"],[60,12,27,10],[60,14,27,12,"CryptoJS"],[60,22,27,20],[60,23,27,20,"default"],[60,30,27,20],[60,31,27,21,"algo"],[60,35,27,25],[60,36,27,26,"SHA256"],[61,4,28,2],[61,5,28,3],[61,6,28,4],[62,4,29,2],[62,11,29,9,"key"],[62,14,29,12],[62,15,29,13,"toString"],[62,23,29,21],[62,24,29,22,"CryptoJS"],[62,32,29,30],[62,33,29,30,"default"],[62,40,29,30],[62,41,29,31,"enc"],[62,44,29,34],[62,45,29,35,"Hex"],[62,48,29,38],[62,49,29,39],[63,2,30,0],[65,2,32,0],[66,0,33,0],[67,0,34,0],[68,2,35,7],[68,17,35,22,"generateSalt"],[68,29,35,34,"generateSalt"],[68,30,35,34],[68,32,35,54],[69,4,36,2],[69,11,36,9,"generateRandomBytes"],[69,30,36,28],[69,31,36,29,"SALT_SIZE"],[69,40,36,38],[69,41,36,39],[70,2,37,0],[72,2,39,0],[73,0,40,0],[74,0,41,0],[75,2,42,7],[75,17,42,22,"generateFEK"],[75,28,42,33,"generateFEK"],[75,29,42,33],[75,31,42,53],[76,4,43,2],[76,11,43,9,"generateRandomBytes"],[76,30,43,28],[76,31,43,29],[76,33,43,31],[76,34,43,32],[76,35,43,33],[76,36,43,34],[77,2,44,0],[79,2,46,0],[80,0,47,0],[81,0,48,0],[82,2,49,7],[82,17,49,22,"generateIV"],[82,27,49,32,"generateIV"],[82,28,49,32],[82,30,49,52],[83,4,50,2],[83,11,50,9,"generateRandomBytes"],[83,30,50,28],[83,31,50,29],[83,33,50,31],[83,34,50,32],[83,35,50,33],[83,36,50,34],[84,2,51,0],[86,2,53,0],[88,2,55,0,"global"],[88,8,55,6],[88,9,55,7,"Buffer"],[88,15,55,13],[88,18,55,16,"global"],[88,24,55,22],[88,25,55,23,"Buffer"],[88,31,55,29],[88,35,55,33,"Buffer"],[88,42,55,39],[88,43,55,39,"Buffer"],[88,49,55,39],[89,0,55,40],[89,3]],"functionMap":{"names":["<global>","generateRandomBytes","deriveMasterKey","generateSalt","generateFEK","generateIV"],"mappings":"AAA;OCa;CDG;OEM;CFO;OGK;CHE;OIK;CJE;OKK;CLE"},"hasCjsExports":false},"type":"js/module"}]}