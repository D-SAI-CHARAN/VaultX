{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":107},"end":{"line":4,"column":33,"index":140}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"expo-crypto","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":141},"end":{"line":5,"column":42,"index":183}}],"key":"+Akla+LrhuGGU54C9zXxLPlFUv4=","exportNames":["*"],"imports":1}},{"name":"buffer","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":54,"column":0,"index":1528},"end":{"line":54,"column":32,"index":1560}}],"key":"L2R9OUI0/cSYwzijo34ce4VujKY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.generateRandomBytes = generateRandomBytes;\n  exports.deriveMasterKey = deriveMasterKey;\n  exports.generateSalt = generateSalt;\n  exports.generateFEK = generateFEK;\n  exports.generateIV = generateIV;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _cryptoJs = require(_dependencyMap[1], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _expoCrypto = require(_dependencyMap[2], \"expo-crypto\");\n  var ExpoRandom = _interopNamespace(_expoCrypto);\n  var _buffer = require(_dependencyMap[3], \"buffer\");\n  // PBKDF2 Key Derivation - Zero Knowledge Vault\n  // Master Key is NEVER stored, always re-derived from PIN\n\n  var ITERATIONS = 100000; // Minimum 100,000 as per spec\n  var KEY_SIZE = 256 / 32; // 256 bits = 8 words (32 bits each)\n  var SALT_SIZE = 16; // 16 bytes = 128 bits\n\n  /**\n   * Generate cryptographically secure random bytes\n   */\n  function generateRandomBytes(_x) {\n    return _generateRandomBytes.apply(this, arguments);\n  }\n  /**\n   * Derive master key from PIN using PBKDF2-HMAC-SHA256\n   * Key is 256 bits, never stored, re-derived on every unlock\n   */\n  function _generateRandomBytes() {\n    _generateRandomBytes = (0, _asyncToGenerator.default)(function* (size) {\n      var randomBytes = yield ExpoRandom.getRandomBytesAsync(size);\n      return _buffer.Buffer.from(randomBytes).toString('hex');\n    });\n    return _generateRandomBytes.apply(this, arguments);\n  }\n  function deriveMasterKey(pin, salt) {\n    var key = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: KEY_SIZE,\n      iterations: ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return key.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Generate a new salt for key derivation\n   */\n  function generateSalt() {\n    return _generateSalt.apply(this, arguments);\n  }\n  /**\n   * Generate a random File Encryption Key (FEK) for each document\n   */\n  function _generateSalt() {\n    _generateSalt = (0, _asyncToGenerator.default)(function* () {\n      return generateRandomBytes(SALT_SIZE);\n    });\n    return _generateSalt.apply(this, arguments);\n  }\n  function generateFEK() {\n    return _generateFEK.apply(this, arguments);\n  }\n  /**\n   * Generate initialization vector for AES-GCM\n   */\n  function _generateFEK() {\n    _generateFEK = (0, _asyncToGenerator.default)(function* () {\n      return generateRandomBytes(32); // 256 bits\n    });\n    return _generateFEK.apply(this, arguments);\n  }\n  function generateIV() {\n    return _generateIV.apply(this, arguments);\n  } // Buffer polyfill for React Native\n  function _generateIV() {\n    _generateIV = (0, _asyncToGenerator.default)(function* () {\n      return generateRandomBytes(12); // 96 bits for GCM\n    });\n    return _generateIV.apply(this, arguments);\n  }\n  global.Buffer = global.Buffer || _buffer.Buffer;\n});","lineCount":109,"map":[[27,2,14,0,"exports"],[27,9,14,0],[27,10,14,0,"generateRandomBytes"],[27,29,14,0],[27,32,14,0,"generateRandomBytes"],[27,51,14,0],[28,2,23,0,"exports"],[28,9,23,0],[28,10,23,0,"deriveMasterKey"],[28,25,23,0],[28,28,23,0,"deriveMasterKey"],[28,43,23,0],[29,2,35,0,"exports"],[29,9,35,0],[29,10,35,0,"generateSalt"],[29,22,35,0],[29,25,35,0,"generateSalt"],[29,37,35,0],[30,2,42,0,"exports"],[30,9,42,0],[30,10,42,0,"generateFEK"],[30,21,42,0],[30,24,42,0,"generateFEK"],[30,35,42,0],[31,2,49,0,"exports"],[31,9,49,0],[31,10,49,0,"generateIV"],[31,20,49,0],[31,23,49,0,"generateIV"],[31,33,49,0],[32,2,51,1],[32,6,51,1,"_babelRuntimeHelpersAsyncToGenerator"],[32,42,51,1],[32,45,51,1,"require"],[32,52,51,1],[32,53,51,1,"_dependencyMap"],[32,67,51,1],[33,2,51,1],[33,6,51,1,"_asyncToGenerator"],[33,23,51,1],[33,26,51,1,"_interopDefault"],[33,41,51,1],[33,42,51,1,"_babelRuntimeHelpersAsyncToGenerator"],[33,78,51,1],[34,2,4,0],[34,6,4,0,"_cryptoJs"],[34,15,4,0],[34,18,4,0,"require"],[34,25,4,0],[34,26,4,0,"_dependencyMap"],[34,40,4,0],[35,2,4,0],[35,6,4,0,"CryptoJS"],[35,14,4,0],[35,17,4,0,"_interopDefault"],[35,32,4,0],[35,33,4,0,"_cryptoJs"],[35,42,4,0],[36,2,5,0],[36,6,5,0,"_expoCrypto"],[36,17,5,0],[36,20,5,0,"require"],[36,27,5,0],[36,28,5,0,"_dependencyMap"],[36,42,5,0],[37,2,5,0],[37,6,5,0,"ExpoRandom"],[37,16,5,0],[37,19,5,0,"_interopNamespace"],[37,36,5,0],[37,37,5,0,"_expoCrypto"],[37,48,5,0],[38,2,54,0],[38,6,54,0,"_buffer"],[38,13,54,0],[38,16,54,0,"require"],[38,23,54,0],[38,24,54,0,"_dependencyMap"],[38,38,54,0],[39,2,1,0],[40,2,2,0],[42,2,7,0],[42,6,7,6,"ITERATIONS"],[42,16,7,16],[42,19,7,19],[42,25,7,25],[42,26,7,26],[42,27,7,27],[43,2,8,0],[43,6,8,6,"KEY_SIZE"],[43,14,8,14],[43,17,8,17],[43,20,8,20],[43,23,8,23],[43,25,8,25],[43,26,8,26],[43,27,8,27],[44,2,9,0],[44,6,9,6,"SALT_SIZE"],[44,15,9,15],[44,18,9,18],[44,20,9,20],[44,21,9,21],[44,22,9,22],[46,2,11,0],[47,0,12,0],[48,0,13,0],[49,2,11,0],[49,11,14,22,"generateRandomBytes"],[49,30,14,41,"generateRandomBytes"],[49,31,14,41,"_x"],[49,33,14,41],[50,4,14,41],[50,11,14,41,"_generateRandomBytes"],[50,31,14,41],[50,32,14,41,"apply"],[50,37,14,41],[50,44,14,41,"arguments"],[50,53,14,41],[51,2,14,41],[52,2,19,0],[53,0,20,0],[54,0,21,0],[55,0,22,0],[56,2,19,0],[56,11,19,0,"_generateRandomBytes"],[56,32,19,0],[57,4,19,0,"_generateRandomBytes"],[57,24,19,0],[57,31,19,0,"_asyncToGenerator"],[57,48,19,0],[57,49,19,0,"default"],[57,56,19,0],[57,58,14,7],[57,69,14,42,"size"],[57,73,14,54],[57,75,14,73],[58,6,15,2],[58,10,15,8,"randomBytes"],[58,21,15,19],[58,30,15,28,"ExpoRandom"],[58,40,15,38],[58,41,15,39,"getRandomBytesAsync"],[58,60,15,58],[58,61,15,59,"size"],[58,65,15,63],[58,66,15,64],[59,6,16,2],[59,13,16,9,"Buffer"],[59,20,16,15],[59,21,16,15,"Buffer"],[59,27,16,15],[59,28,16,16,"from"],[59,32,16,20],[59,33,16,21,"randomBytes"],[59,44,16,32],[59,45,16,33],[59,46,16,34,"toString"],[59,54,16,42],[59,55,16,43],[59,60,16,48],[59,61,16,49],[60,4,17,0],[60,5,17,1],[61,4,17,1],[61,11,17,1,"_generateRandomBytes"],[61,31,17,1],[61,32,17,1,"apply"],[61,37,17,1],[61,44,17,1,"arguments"],[61,53,17,1],[62,2,17,1],[63,2,23,7],[63,11,23,16,"deriveMasterKey"],[63,26,23,31,"deriveMasterKey"],[63,27,23,32,"pin"],[63,30,23,43],[63,32,23,45,"salt"],[63,36,23,57],[63,38,23,67],[64,4,24,2],[64,8,24,8,"key"],[64,11,24,11],[64,14,24,14,"CryptoJS"],[64,22,24,22],[64,23,24,22,"default"],[64,30,24,22],[64,31,24,23,"PBKDF2"],[64,37,24,29],[64,38,24,30,"pin"],[64,41,24,33],[64,43,24,35,"CryptoJS"],[64,51,24,43],[64,52,24,43,"default"],[64,59,24,43],[64,60,24,44,"enc"],[64,63,24,47],[64,64,24,48,"Hex"],[64,67,24,51],[64,68,24,52,"parse"],[64,73,24,57],[64,74,24,58,"salt"],[64,78,24,62],[64,79,24,63],[64,81,24,65],[65,6,25,4,"keySize"],[65,13,25,11],[65,15,25,13,"KEY_SIZE"],[65,23,25,21],[66,6,26,4,"iterations"],[66,16,26,14],[66,18,26,16,"ITERATIONS"],[66,28,26,26],[67,6,27,4,"hasher"],[67,12,27,10],[67,14,27,12,"CryptoJS"],[67,22,27,20],[67,23,27,20,"default"],[67,30,27,20],[67,31,27,21,"algo"],[67,35,27,25],[67,36,27,26,"SHA256"],[68,4,28,2],[68,5,28,3],[68,6,28,4],[69,4,29,2],[69,11,29,9,"key"],[69,14,29,12],[69,15,29,13,"toString"],[69,23,29,21],[69,24,29,22,"CryptoJS"],[69,32,29,30],[69,33,29,30,"default"],[69,40,29,30],[69,41,29,31,"enc"],[69,44,29,34],[69,45,29,35,"Hex"],[69,48,29,38],[69,49,29,39],[70,2,30,0],[72,2,32,0],[73,0,33,0],[74,0,34,0],[75,2,32,0],[75,11,35,22,"generateSalt"],[75,23,35,34,"generateSalt"],[75,24,35,34],[76,4,35,34],[76,11,35,34,"_generateSalt"],[76,24,35,34],[76,25,35,34,"apply"],[76,30,35,34],[76,37,35,34,"arguments"],[76,46,35,34],[77,2,35,34],[78,2,39,0],[79,0,40,0],[80,0,41,0],[81,2,39,0],[81,11,39,0,"_generateSalt"],[81,25,39,0],[82,4,39,0,"_generateSalt"],[82,17,39,0],[82,24,39,0,"_asyncToGenerator"],[82,41,39,0],[82,42,39,0,"default"],[82,49,39,0],[82,51,35,7],[82,64,35,54],[83,6,36,2],[83,13,36,9,"generateRandomBytes"],[83,32,36,28],[83,33,36,29,"SALT_SIZE"],[83,42,36,38],[83,43,36,39],[84,4,37,0],[84,5,37,1],[85,4,37,1],[85,11,37,1,"_generateSalt"],[85,24,37,1],[85,25,37,1,"apply"],[85,30,37,1],[85,37,37,1,"arguments"],[85,46,37,1],[86,2,37,1],[87,2,37,1],[87,11,42,22,"generateFEK"],[87,22,42,33,"generateFEK"],[87,23,42,33],[88,4,42,33],[88,11,42,33,"_generateFEK"],[88,23,42,33],[88,24,42,33,"apply"],[88,29,42,33],[88,36,42,33,"arguments"],[88,45,42,33],[89,2,42,33],[90,2,46,0],[91,0,47,0],[92,0,48,0],[93,2,46,0],[93,11,46,0,"_generateFEK"],[93,24,46,0],[94,4,46,0,"_generateFEK"],[94,16,46,0],[94,23,46,0,"_asyncToGenerator"],[94,40,46,0],[94,41,46,0,"default"],[94,48,46,0],[94,50,42,7],[94,63,42,53],[95,6,43,2],[95,13,43,9,"generateRandomBytes"],[95,32,43,28],[95,33,43,29],[95,35,43,31],[95,36,43,32],[95,37,43,33],[95,38,43,34],[96,4,44,0],[96,5,44,1],[97,4,44,1],[97,11,44,1,"_generateFEK"],[97,23,44,1],[97,24,44,1,"apply"],[97,29,44,1],[97,36,44,1,"arguments"],[97,45,44,1],[98,2,44,1],[99,2,44,1],[99,11,49,22,"generateIV"],[99,21,49,32,"generateIV"],[99,22,49,32],[100,4,49,32],[100,11,49,32,"_generateIV"],[100,22,49,32],[100,23,49,32,"apply"],[100,28,49,32],[100,35,49,32,"arguments"],[100,44,49,32],[101,2,49,32],[101,4,53,0],[102,2,53,0],[102,11,53,0,"_generateIV"],[102,23,53,0],[103,4,53,0,"_generateIV"],[103,15,53,0],[103,22,53,0,"_asyncToGenerator"],[103,39,53,0],[103,40,53,0,"default"],[103,47,53,0],[103,49,49,7],[103,62,49,52],[104,6,50,2],[104,13,50,9,"generateRandomBytes"],[104,32,50,28],[104,33,50,29],[104,35,50,31],[104,36,50,32],[104,37,50,33],[104,38,50,34],[105,4,51,0],[105,5,51,1],[106,4,51,1],[106,11,51,1,"_generateIV"],[106,22,51,1],[106,23,51,1,"apply"],[106,28,51,1],[106,35,51,1,"arguments"],[106,44,51,1],[107,2,51,1],[108,2,55,0,"global"],[108,8,55,6],[108,9,55,7,"Buffer"],[108,15,55,13],[108,18,55,16,"global"],[108,24,55,22],[108,25,55,23,"Buffer"],[108,31,55,29],[108,35,55,33,"Buffer"],[108,42,55,39],[108,43,55,39,"Buffer"],[108,49,55,39],[109,0,55,40],[109,3]],"functionMap":{"names":["<global>","generateRandomBytes","deriveMasterKey","generateSalt","generateFEK","generateIV"],"mappings":"AAA;OCa;CDG;OEM;CFO;OGK;CHE;OIK;CJE;OKK;CLE"},"hasCjsExports":false},"type":"js/module"}]}